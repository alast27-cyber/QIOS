<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHIPS:// Browser & Quantum Node</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #0f172a; color: #e5e7eb; }
        .console { background-color: #1e293b; font-family: monospace; height: 400px; overflow-y: auto; border-radius: 0.5rem; padding: 1rem; }
    </style>
</head>
<body class="p-6">
    <div class="max-w-4xl mx-auto space-y-6">
        <header>
            <h1 class="text-3xl font-bold">CHIPS:// Browser & Quantum Node</h1>
            <p id="connection-status" class="text-xl mt-2 font-semibold text-red-500">Connecting to Back Office...</p>
        </header>
        <section>
            <h2 class="text-xl font-semibold mb-3">Node Log</h2>
            <div id="nodeLog" class="console"></div>
        </section>
    </div>

<script>
    const nodeLog = document.getElementById('nodeLog');
    const connectionStatus = document.getElementById('connection-status');
    
    const socket = io("https://qios-2.onrender.com", { transports: ['websocket'] });

    function log(message, type = 'info') {
        const p = document.createElement('p');
        p.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        if (type === 'error') p.className = 'text-red-400';
        else if (type === 'warn') p.className = 'text-yellow-400';
        else if (type === 'success') p.className = 'text-green-400';
        else p.className = 'text-cyan-400';
        nodeLog.appendChild(p);
        nodeLog.scrollTop = nodeLog.scrollHeight;
    }

    socket.on('connect', () => {
        connectionStatus.textContent = `CONNECTION STABLE. Node ID: ${socket.id.substring(0,6)}...`;
        connectionStatus.className = 'text-xl mt-2 font-semibold text-green-400';
        log('Successfully connected to QIOS Back Office.', 'success');
        socket.emit('register_node');
    });

    socket.on('ping', () => { socket.emit('pong'); });

    socket.on('disconnect', () => {
        connectionStatus.textContent = 'CONNECTION LOST. RECONNECTING...';
        connectionStatus.className = 'text-xl mt-2 font-semibold text-red-500';
        log('Connection lost.', 'error');
    });
    
    socket.on('log_message', (data) => {
        log(data.message, data.type);
    });
</script>
</body>
</html>
